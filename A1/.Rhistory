#Read data
rawdata = read.csv("Project1Data.csv",header=T)
getwd()
#Read data
rawdata = read.csv("Project1Data.csv",header=T)
#Check data
head(rawdata)
tail(rawdata)
#Adjustment for Inflation
rawdata$cprice <- rawdata$cprice/rawdata$oprice
rawdata$tprice <- rawdata$tprice/rawdata$oprice
rawdata$bprice <- rawdata$bprice/rawdata$oprice
rawdata$wprice <- rawdata$wprice/rawdata$oprice
rawdata$incom <- rawdata$incom/rawdata$oprice
#Construction of variables in logs
rawdata$ln_qu <- log(rawdata$qu)
rawdata$ln_cprice <- log(rawdata$cprice)
rawdata$ln_tprice <- log(rawdata$tprice)
rawdata$ln_incom <- log(rawdata$incom)
rawdata$ln_bprice <- log(rawdata$bprice)
rawdata$ln_wprice <- log(rawdata$wprice)
#Plot data
library(ggplot2)
ggplot(rawdata,aes(ln_qu, ln_cprice)) + geom_point() + geom_smooth(method = "lm")
demand1.lm <- lm(ln_qu ~ ln_cprice,data=rawdata)
summary(demand1.lm)
demand2.lm <- lm(ln_qu ~ ln_cprice + ln_incom + ln_tprice + q1 + q2 + q3,data=rawdata )
summary(demand2.lm)
cprice_IV_test <- lm(ln_cprice ~ln_incom + q1 + q2 + q3 + ln_wprice + ln_bprice + ln_tprice )
cprice_IV_test <- lm(ln_cprice ~ln_incom + q1 + q2 + q3 + ln_wprice + ln_bprice + ln_tpriceï¼Œdata=rawdata )
summary(cprice_IV_test)
library(AER)
#Run 2SLS on ln_cprice
demand.2sls.form <- ivreg(ln_qu ~ ln_cprice + ln_incom + q1 + q2 + q3 | ln_incom + q1 + q2 + q3 + ln_wprice + ln_bprice,data=rawdata)
summary(demand.2sls.form, diagnostics = TRUE)
#Naive Supply Function Estimation
supply1.lm <- lm(ln_qu ~ ln_cprice,data=rawdata)
summary(supply1.lm)
#Supply Function OLS Estimation
supply2.lm <- lm(ln_qu ~ ln_cprice + ln_wprice + ln_bprice + q1 + q2 + q3,data=rawdata)
summary(supply2.lm)
##explain why cprice is endogeneous?????Do we need to validate endogeneity???????????
cprice_endo_test <- lm(supply2.lm$residuals ~ ln_cprice,data=rawdata)
#Run 2SLS for supply functiin on ln_cprice, income price and tea price are used as IV
library(AER)
supply.2sls.form <- ivreg(ln_qu ~ ln_cprice + ln_wprice + ln_bprice + q1 + q2 + q3 | ln_wprice + ln_bprice + q1 + q2 + q3 + ln_incom + ln_tprice, data=rawdata)
summary(supply.2sls.form, diagnostics = TRUE)
